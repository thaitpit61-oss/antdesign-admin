{"version":3,"sources":["src/pages/project/forms/detail/index.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { PageContainer, ProCard, ProDescriptions } from '@ant-design/pro-components';\r\nimport { Button, Spin, Tag, message } from 'antd';\r\nimport { history, useParams } from '@umijs/max';\r\n\r\ntype ProjectForm = {\r\n  id: number;\r\n  tenBieuMau: string;\r\n  loaiBieuMau: string;\r\n  duAn: string;\r\n  dienGiai: string;\r\n  khoa: boolean;\r\n  nvTao: string;\r\n  ngayTao: string;\r\n  nvCapNhat: string;\r\n  ngayCapNhat: string;\r\n};\r\n\r\n// mock giống list của bạn\r\nconst MOCK_FORMS: ProjectForm[] = [\r\n  {\r\n    id: 1,\r\n    tenBieuMau: 'Phiếu khảo sát',\r\n    loaiBieuMau: 'Khảo sát khách hàng',\r\n    duAn: 'Dự án A',\r\n    dienGiai: 'Phiếu khảo sát chất lượng',\r\n    khoa: false,\r\n    nvTao: 'Nguyễn A',\r\n    ngayTao: '2025-05-10',\r\n    nvCapNhat: 'Trần B',\r\n    ngayCapNhat: '2025-06-01',\r\n  },\r\n  {\r\n    id: 2,\r\n    tenBieuMau: 'Phiếu đăng ký',\r\n    loaiBieuMau: 'Đăng ký tham gia',\r\n    duAn: 'Dự án B',\r\n    dienGiai: 'Phiếu đăng ký sự kiện',\r\n    khoa: true,\r\n    nvTao: 'Lê C',\r\n    ngayTao: '2025-06-01',\r\n    nvCapNhat: 'Lê C',\r\n    ngayCapNhat: '2025-06-02',\r\n  },\r\n];\r\n\r\nasync function fetchFormById(id: number): Promise<ProjectForm | null> {\r\n  await new Promise((r) => setTimeout(r, 200));\r\n  return MOCK_FORMS.find((x) => x.id === id) ?? null;\r\n}\r\n\r\nconst ProjectFormDetail: React.FC = () => {\r\n  const params = useParams<{ id: string }>();\r\n  const formId = useMemo(() => Number(params.id), [params.id]);\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [form, setForm] = useState<ProjectForm | null>(null);\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n\r\n    const run = async () => {\r\n      if (!Number.isFinite(formId) || formId <= 0) {\r\n        message.error('ID biểu mẫu không hợp lệ');\r\n        history.push('/project/forms');\r\n        return;\r\n      }\r\n\r\n      setLoading(true);\r\n      try {\r\n        const res = await fetchFormById(formId);\r\n        if (cancelled) return;\r\n\r\n        if (!res) {\r\n          message.warning('Không tìm thấy biểu mẫu');\r\n          history.push('/project/forms');\r\n          return;\r\n        }\r\n\r\n        setForm(res);\r\n      } catch {\r\n        if (!cancelled) message.error('Lỗi tải dữ liệu biểu mẫu');\r\n      } finally {\r\n        if (!cancelled) setLoading(false);\r\n      }\r\n    };\r\n\r\n    run();\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [formId]);\r\n\r\n  return (\r\n    <PageContainer\r\n      title=\"Chi tiết biểu mẫu\"\r\n      onBack={() => history.push('/project/forms')}\r\n      extra={[\r\n        <Button key=\"back\" onClick={() => history.push('/project/forms')}>\r\n          Quay lại danh sách\r\n        </Button>,\r\n        <Button\r\n          key=\"edit\"\r\n          type=\"primary\"\r\n          disabled={!form}\r\n          onClick={() => history.push(`/project/forms/${formId}/edit`)}\r\n        >\r\n          Sửa\r\n        </Button>,\r\n      ]}\r\n    >\r\n      <Spin spinning={loading}>\r\n        {form && (\r\n          <ProCard>\r\n            <ProDescriptions<ProjectForm>\r\n              column={2}\r\n              dataSource={form}\r\n              columns={[\r\n                { title: 'ID', dataIndex: 'id' },\r\n                { title: 'Tên biểu mẫu', dataIndex: 'tenBieuMau' },\r\n                { title: 'Loại biểu mẫu', dataIndex: 'loaiBieuMau' },\r\n                { title: 'Dự án', dataIndex: 'duAn' },\r\n                {\r\n                  title: 'Trạng thái',\r\n                  dataIndex: 'khoa',\r\n                  render: (_, r) => (\r\n                    <Tag color={r.khoa ? 'red' : 'green'}>{r.khoa ? 'Khóa' : 'Hoạt động'}</Tag>\r\n                  ),\r\n                },\r\n                { title: 'Diễn giải', dataIndex: 'dienGiai', span: 2 },\r\n                { title: 'Nhân viên tạo', dataIndex: 'nvTao' },\r\n                { title: 'Ngày tạo', dataIndex: 'ngayTao' },\r\n                { title: 'Nhân viên cập nhật', dataIndex: 'nvCapNhat' },\r\n                { title: 'Ngày cập nhật', dataIndex: 'ngayCapNhat' },\r\n              ]}\r\n            />\r\n          </ProCard>\r\n        )}\r\n      </Spin>\r\n    </PageContainer>\r\n  );\r\n};\r\n\r\nexport default ProjectFormDetail;\r\n"],"names":[],"mappings":"iQA+IA,+CAAA,8CA/IoD,oJAGjB,YAgBnC,IAAM,EAA4B,CAChC,CACE,GAAI,EACJ,WAAY,8BACZ,YAAa,oCACb,KAAM,kBACN,SAAU,wDACV,KAAM,CAAA,EACN,MAAO,gBACP,QAAS,aACT,UAAW,cACX,YAAa,YACf,EACA,CACE,GAAI,EACJ,WAAY,kCACZ,YAAa,gCACb,KAAM,kBACN,SAAU,oDACV,KAAM,CAAA,EACN,MAAO,UACP,QAAS,aACT,UAAW,UACX,YAAa,YACf,EACD,CAED,eAAe,EAAc,CAAU,EAErC,OADA,MAAM,IAAI,QAAQ,AAAC,GAAM,WAAW,EAAG,MAChC,EAAW,IAAI,CAAC,AAAC,GAAM,EAAE,EAAE,GAAK,IAAO,KAChD,KA8FA,EA5FoC,KAClC,IAAM,EAAS,GAAA,WAAS,IAClB,EAAS,GAAA,SAAO,EAAC,IAAM,OAAO,EAAO,EAAE,EAAG,CAAC,EAAO,EAAE,CAAC,EAErD,CAAC,EAAS,EAAW,CAAG,GAAA,UAAQ,EAAC,CAAA,GACjC,CAAC,EAAM,EAAQ,CAAG,GAAA,UAAQ,EAAqB,MAqCrD,MAnCA,GAAA,WAAS,EAAC,KACR,IAAI,EAAY,CAAA,EA6BhB,MADA,AA1BY,CAAA,UACV,GAAI,CAAC,OAAO,QAAQ,CAAC,IAAW,GAAU,EAAG,CAC3C,SAAO,CAAC,KAAK,CAAC,mDACd,SAAO,CAAC,IAAI,CAAC,kBACb,OACF,CAEA,EAAW,CAAA,GACX,GAAI,CACF,IAAM,EAAM,MAAM,EAAc,GAChC,GAAI,EAAW,OAEf,GAAI,CAAC,EAAK,CACR,SAAO,CAAC,OAAO,CAAC,gDAChB,SAAO,CAAC,IAAI,CAAC,kBACb,OACF,CAEA,EAAQ,GACV,CAAE,KAAM,CACD,GAAW,SAAO,CAAC,KAAK,CAAC,0DAChC,QAAU,CACH,GAAW,EAAW,CAAA,GAC7B,CACF,CAAA,IAGO,KACL,EAAY,CAAA,EACd,EACF,EAAG,CAAC,EAAO,EAGT,UAAC,eAAa,EACZ,MAAM,mCACN,OAAQ,IAAM,SAAO,CAAC,IAAI,CAAC,kBAC3B,MAAO,CACL,UAAC,SAAM,EAAY,QAAS,IAAM,SAAO,CAAC,IAAI,CAAC,2BAAmB,8BAAtD,QAGZ,UAAC,SAAM,EAEL,KAAK,UACL,SAAU,CAAC,EACX,QAAS,IAAM,SAAO,CAAC,IAAI,CAAC,CAAC,eAAe,EAAE,EAAO,KAAK,CAAC,WAC5D,YAJK,QAOP,UAED,UAAC,SAAI,EAAC,SAAU,WACb,GACC,UAAC,SAAO,WACN,UAAC,iBAAe,EACd,OAAQ,EACR,WAAY,EACZ,QAAS,CACP,CAAE,MAAO,KAAM,UAAW,IAAK,EAC/B,CAAE,MAAO,4BAAgB,UAAW,YAAa,EACjD,CAAE,MAAO,+BAAiB,UAAW,aAAc,EACnD,CAAE,MAAO,gBAAS,UAAW,MAAO,EACpC,CACE,MAAO,qBACP,UAAW,OACX,OAAQ,CAAC,EAAG,IACV,UAAC,SAAG,EAAC,MAAO,EAAE,IAAI,CAAG,MAAQ,iBAAU,EAAE,IAAI,CAAG,UAAS,4BAE7D,EACA,CAAE,MAAO,sBAAa,UAAW,WAAY,KAAM,CAAE,EACrD,CAAE,MAAO,2BAAiB,UAAW,OAAQ,EAC7C,CAAE,MAAO,mBAAY,UAAW,SAAU,EAC1C,CAAE,MAAO,qCAAsB,UAAW,WAAY,EACtD,CAAE,MAAO,6BAAiB,UAAW,aAAc,EACpD,SAOf"}