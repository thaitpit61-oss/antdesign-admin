{"version":3,"sources":["src/pages/product/detail/index.tsx"],"sourcesContent":["import {\r\n  PageContainer,\r\n  ProCard,\r\n  ProDescriptions,\r\n} from \"@ant-design/pro-components\";\r\nimport { Button, Spin, Tag, message } from \"antd\";\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport { history, useParams } from \"umi\";\r\n\r\ntype Product = {\r\n  stt: number;\r\n  trangThai: \"Available\" | \"Sold\" | string;\r\n  maCan: string;\r\n  duAn: string;\r\n  dotBanHang: string;\r\n  loaiSP: string;\r\n  tang: string;\r\n  dienTich: string;\r\n  donGia: string;\r\n  tongGia: string;\r\n  chietKhau: string;\r\n  tongSauCK: string;\r\n};\r\n\r\n// Mock data (giống bên list)\r\nconst MOCK_PRODUCTS: Product[] = [\r\n  {\r\n    stt: 1,\r\n    trangThai: \"Available\",\r\n    maCan: \"C-001\",\r\n    duAn: \"Dự án A\",\r\n    dotBanHang: \"Đợt 1\",\r\n    loaiSP: \"Căn hộ\",\r\n    tang: \"Tầng 5\",\r\n    dienTich: \"75 m2\",\r\n    donGia: \"1,200,000\",\r\n    tongGia: \"90,000,000\",\r\n    chietKhau: \"5%\",\r\n    tongSauCK: \"85,500,000\",\r\n  },\r\n  {\r\n    stt: 2,\r\n    trangThai: \"Sold\",\r\n    maCan: \"C-002\",\r\n    duAn: \"Dự án B\",\r\n    dotBanHang: \"Đợt 2\",\r\n    loaiSP: \"Studio\",\r\n    tang: \"Tầng 3\",\r\n    dienTich: \"40 m2\",\r\n    donGia: \"900,000\",\r\n    tongGia: \"36,000,000\",\r\n    chietKhau: \"0%\",\r\n    tongSauCK: \"36,000,000\",\r\n  },\r\n];\r\n\r\n// Tạm thời mock “API”\r\nasync function fetchProductByMaCan(maCan: string): Promise<Product | null> {\r\n  await new Promise((r) => setTimeout(r, 200));\r\n  return MOCK_PRODUCTS.find((p) => p.maCan === maCan) ?? null;\r\n}\r\n\r\nconst ProductDetail: React.FC = () => {\r\n  const params = useParams<{ maCan?: string }>();\r\n  const maCan = useMemo(() => (params.maCan ?? \"\").trim(), [params.maCan]);\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [product, setProduct] = useState<Product | null>(null);\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n\r\n    async function run() {\r\n      if (!maCan) {\r\n        console.log(\"maCan\", maCan);\r\n        message.error(\"Mã căn không hợp lệ\");\r\n        history.push(\"/product/list\");\r\n        return;\r\n      }\r\n\r\n      setLoading(true);\r\n      try {\r\n        const res = await fetchProductByMaCan(maCan);\r\n        if (cancelled) return;\r\n\r\n        if (!res) {\r\n          message.warning(\"Không tìm thấy sản phẩm\");\r\n          history.push(\"/product/list\");\r\n          return;\r\n        }\r\n\r\n        setProduct(res);\r\n      } catch (e) {\r\n        if (!cancelled) message.error(\"Lỗi tải dữ liệu sản phẩm\");\r\n      } finally {\r\n        if (!cancelled) setLoading(false);\r\n      }\r\n    }\r\n\r\n    run();\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [maCan]);\r\n\r\n  const statusTag = (status: string) => {\r\n    const s = status?.toLowerCase?.() ?? \"\";\r\n    const color =\r\n      s === \"available\" ? \"green\" : s === \"sold\" ? \"red\" : \"default\";\r\n    return <Tag color={color}>{status}</Tag>;\r\n  };\r\n\r\n  return (\r\n    <PageContainer\r\n      title=\"Chi tiết sản phẩm\"\r\n      onBack={() => history.push(\"/product/list\")}\r\n      extra={[\r\n        <Button key=\"back\" onClick={() => history.push(\"/product/list\")}>\r\n          Quay lại danh sách\r\n        </Button>,\r\n        <Button\r\n          key=\"edit\"\r\n          type=\"primary\"\r\n          disabled={!product}\r\n          onClick={() => history.push(`/product/edit/${maCan}`)}\r\n        >\r\n          Sửa\r\n        </Button>,\r\n      ]}\r\n    >\r\n      <Spin spinning={loading}>\r\n        {product ? (\r\n          <ProCard gutter={16} direction=\"column\">\r\n            <ProCard title=\"Thông tin sản phẩm\" bordered>\r\n              <ProDescriptions<Product>\r\n                column={2}\r\n                dataSource={product}\r\n                columns={[\r\n                  { title: \"Mã căn\", dataIndex: \"maCan\" },\r\n                  { title: \"STT\", dataIndex: \"stt\" },\r\n                  {\r\n                    title: \"Trạng thái\",\r\n                    dataIndex: \"trangThai\",\r\n                    render: (_, record) => statusTag(record.trangThai),\r\n                  },\r\n                  { title: \"Loại sản phẩm\", dataIndex: \"loaiSP\" },\r\n                  { title: \"Tầng\", dataIndex: \"tang\" },\r\n                  { title: \"Diện tích\", dataIndex: \"dienTich\" },\r\n                  { title: \"Dự án\", dataIndex: \"duAn\" },\r\n                  { title: \"Đợt bán hàng\", dataIndex: \"dotBanHang\" },\r\n                ]}\r\n              />\r\n            </ProCard>\r\n\r\n            <ProCard title=\"Giá & chiết khấu\" bordered>\r\n              <ProDescriptions<Product>\r\n                column={2}\r\n                dataSource={product}\r\n                columns={[\r\n                  { title: \"Đơn giá\", dataIndex: \"donGia\" },\r\n                  { title: \"Tổng giá\", dataIndex: \"tongGia\" },\r\n                  { title: \"Chiết khấu\", dataIndex: \"chietKhau\" },\r\n                  { title: \"Tổng sau CK\", dataIndex: \"tongSauCK\" },\r\n                ]}\r\n              />\r\n            </ProCard>\r\n          </ProCard>\r\n        ) : null}\r\n      </Spin>\r\n    </PageContainer>\r\n  );\r\n};\r\n\r\nexport default ProductDetail;\r\n"],"names":[],"mappings":"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"}