{"version":3,"sources":["src/pages/project/detail/index.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { PageContainer, ProDescriptions, ProCard } from '@ant-design/pro-components';\r\nimport { Button, Tag, Spin, message } from 'antd';\r\nimport { history, useParams } from '@umijs/max';\r\n\r\ntype Project = {\r\n  id: number;\r\n  ngay: string;\r\n  code: string;\r\n  maFast: string;\r\n  tenDuAn: string;\r\n  loaiDuAn: string;\r\n  nhanVien: string;\r\n  dienTich: string;\r\n  soGiayPhep: string;\r\n  ngayCap: string;\r\n  donGia: string;\r\n  soLuong: number;\r\n  diaChi: string;\r\n  ngayDuyet: string;\r\n  nguoiDuyet: string;\r\n  daDuyet: boolean;\r\n};\r\n\r\n// Mock data (giống bên list)\r\nconst MOCK_PROJECTS: Project[] = [\r\n  {\r\n    id: 1,\r\n    ngay: '2025-01-01',\r\n    code: 'DA-001',\r\n    maFast: 'MF001',\r\n    tenDuAn: 'Dự án A',\r\n    loaiDuAn: 'Loại 1',\r\n    nhanVien: 'Nguyễn A',\r\n    dienTich: '120 m2',\r\n    soGiayPhep: 'GP-123',\r\n    ngayCap: '2024-12-01',\r\n    donGia: '1,000,000',\r\n    soLuong: 10,\r\n    diaChi: 'Hà Nội',\r\n    ngayDuyet: '2024-12-15',\r\n    nguoiDuyet: 'Ban QL',\r\n    daDuyet: true,\r\n  },\r\n  {\r\n    id: 2,\r\n    ngay: '2025-02-02',\r\n    code: 'DA-002',\r\n    maFast: 'MF002',\r\n    tenDuAn: 'Dự án B',\r\n    loaiDuAn: 'Loại 2',\r\n    nhanVien: 'Trần B',\r\n    dienTich: '80 m2',\r\n    soGiayPhep: 'GP-456',\r\n    ngayCap: '2024-11-20',\r\n    donGia: '800,000',\r\n    soLuong: 5,\r\n    diaChi: 'Hồ Chí Minh',\r\n    ngayDuyet: '2024-11-30',\r\n    nguoiDuyet: 'BGĐ',\r\n    daDuyet: false,\r\n  },\r\n];\r\n\r\n// Tạm thời mock “API”\r\nasync function fetchProjectById(id: number): Promise<Project | null> {\r\n  // giả lập delay\r\n  await new Promise((r) => setTimeout(r, 200));\r\n  return MOCK_PROJECTS.find((p) => p.id === id) ?? null;\r\n}\r\n\r\nconst ProjectDetail: React.FC = () => {\r\n  const params = useParams<{ id: string }>();\r\n  const projectId = useMemo(() => Number(params.id), [params.id]);\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [project, setProject] = useState<Project | null>(null);\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n\r\n    async function run() {\r\n      if (!Number.isFinite(projectId) || projectId <= 0) {\r\n        message.error('ID dự án không hợp lệ');\r\n        history.push('/project/list');\r\n        return;\r\n      }\r\n\r\n      setLoading(true);\r\n      try {\r\n        const res = await fetchProjectById(projectId);\r\n        if (cancelled) return;\r\n\r\n        if (!res) {\r\n          message.warning('Không tìm thấy dự án');\r\n          history.push('/project/list');\r\n          return;\r\n        }\r\n\r\n        setProject(res);\r\n      } catch (e) {\r\n        if (!cancelled) message.error('Lỗi tải dữ liệu dự án');\r\n      } finally {\r\n        if (!cancelled) setLoading(false);\r\n      }\r\n    }\r\n\r\n    run();\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [projectId]);\r\n\r\n  return (\r\n    <PageContainer\r\n      title=\"Chi tiết dự án\"\r\n      onBack={() => history.push('/project/list')}\r\n      extra={[\r\n        <Button key=\"back\" onClick={() => history.push('/project/list')}>\r\n          Quay lại danh sách\r\n        </Button>,\r\n        <Button\r\n          key=\"edit\"\r\n          type=\"primary\"\r\n          disabled={!project}\r\n          onClick={() => history.push(`/project/edit/${projectId}`)}\r\n        >\r\n          Sửa\r\n        </Button>,\r\n      ]}\r\n    >\r\n      <Spin spinning={loading}>\r\n        {project ? (\r\n          <ProCard gutter={16} direction=\"column\">\r\n            <ProCard title=\"Thông tin chung\" bordered>\r\n              <ProDescriptions<Project>\r\n                column={2}\r\n                dataSource={project}\r\n                columns={[\r\n                  { title: 'ID', dataIndex: 'id' },\r\n                  { title: 'Mã', dataIndex: 'code' },\r\n                  { title: 'Mã Fast', dataIndex: 'maFast' },\r\n                  { title: 'Tên dự án', dataIndex: 'tenDuAn' },\r\n                  { title: 'Loại dự án', dataIndex: 'loaiDuAn' },\r\n                  { title: 'Nhân viên', dataIndex: 'nhanVien' },\r\n                  { title: 'Địa chỉ', dataIndex: 'diaChi' },\r\n                  { title: 'Ngày', dataIndex: 'ngay' },\r\n                ]}\r\n              />\r\n            </ProCard>\r\n\r\n            <ProCard title=\"Thông tin pháp lý / chi phí\" bordered>\r\n              <ProDescriptions<Project>\r\n                column={2}\r\n                dataSource={project}\r\n                columns={[\r\n                  { title: 'Diện tích', dataIndex: 'dienTich' },\r\n                  { title: 'Số giấy phép', dataIndex: 'soGiayPhep' },\r\n                  { title: 'Ngày cấp', dataIndex: 'ngayCap' },\r\n                  { title: 'Đơn giá', dataIndex: 'donGia' },\r\n                  { title: 'Số lượng', dataIndex: 'soLuong' },\r\n                  {\r\n                    title: 'Đã duyệt',\r\n                    dataIndex: 'daDuyet',\r\n                    render: (_, record) => (\r\n                      <Tag color={record.daDuyet ? 'green' : 'default'}>\r\n                        {record.daDuyet ? 'Yes' : 'No'}\r\n                      </Tag>\r\n                    ),\r\n                  },\r\n                  { title: 'Ngày duyệt', dataIndex: 'ngayDuyet' },\r\n                  { title: 'Người duyệt', dataIndex: 'nguoiDuyet' },\r\n                ]}\r\n              />\r\n            </ProCard>\r\n          </ProCard>\r\n        ) : null}\r\n      </Spin>\r\n    </PageContainer>\r\n  );\r\n};\r\n\r\nexport default ProjectDetail;\r\n"],"names":[],"mappings":"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"}